{% extends "documents/todo.html" %}
{% load i18n %}
{% load basename %}
{% load verbose_name %}

{% block title %}{{ block.super }} - {% trans "Document Details" %} - {{ document.title }}{% endblock %}

{% block content %}
{% if document %}
<div class="contextual">
  <a href="{% url todo_ocr document.id %}" accesskey="o" class="icon icon-ocr">{% trans "OCR" %}</a>
  <a href="{% url todo_markup document.id %}" accesskey="m" class="icon icon-edit">{% trans "Markup" %}</a>
</div>

<h2>{% trans "Document Details" %}</h2>

<div class="issue">
  
  <h3>{{ document.title }}</h3>
  <!-- <p class="author"> -->
  <!--   Added by <a href="">Christian Egli</a> 28 days ago. -->
  <!--   Updated 19 days ago. -->
  <!-- </p> -->
  
  {% include "documents/documentDetails.html" %}

  <div id="relations">
    <!-- <div class="contextual"> -->
    <!--   <a href="#" onclick="Element.toggle('new-version-form'); this.blur(); return false;">Add</a> -->
    <!-- </div> -->
    
    <p><strong>{% trans "Versions" %}</strong></p>
    <table style="width:100%">
      <!-- <tr> -->
      <!-- 	<th>Comment</th> -->
      <!-- 	<th>Created at</th> -->
      <!-- </tr> -->
      {% for version in document.version_set.all %}
      <tr>
	<td><a href="{{ version.content.url }}">{{ version.comment }}</a></td>
	<td>{{ version.created_at|date }}</td>
	<!-- <td> -->
	<!--   <a href="#" title="Delete relation"> -->
	<!--     <img alt="Delete" src="/images/delete.png" /> -->
	<!--   </a> -->
	<!-- </td> -->
      </tr>
      {% endfor %}
    </table>

    <form enctype="multipart/form-data" method="post" 
	  action="{% url todo_add_version document.id %}">
	  <!-- id="new-version-form" style="display: none;"> -->
      <p>
	{% with versionForm as form %}
	{% include "documents/simpleForm.html" %}
	{% endwith %}
	<input type="submit" value="{% trans 'Add' %}" /> 
	<!-- <a href="#" onclick="Element.toggle('new-version-form'); this.blur(); return false;">Cancel</a> -->
      </p>
    </form>
  </div>
  <hr />
  
  <div id="relations">
    <!-- <div class="contextual"> -->
    <!--   <a href="#" onclick="Element.toggle('new-attachment-form'); this.blur(); return false;">Add</a> -->
    <!-- </div> -->
    
    <p><strong>{% trans "Attachments" %}</strong></p>
    <table style="width:100%">
      <!-- <tr> -->
      <!-- 	<th>Name</th> -->
      <!-- 	<th>Comment</th> -->
      <!-- 	<th>Mime type</th> -->
      <!-- 	<th>Created at</th> -->
      <!-- </tr> -->
      {% for attachment in document.attachment_set.all %}
      <tr>
	<td><a href="{{ attachment.content.url }}">{{ attachment.content.name|basename }}</a></td>
	<td>{{ attachment.comment }}</td>
	<td>{{ attachment.mime_type }}</td>
	<td>{{ attachment.created_at|date }}</td>
	<!-- <td> -->
	<!--   <a href="#" title="Delete relation"> -->
	<!--     <img alt="Delete" src="/images/delete.png" /> -->
	<!--   </a> -->
	<!-- </td> -->
      </tr>
      {% endfor %}
    </table>
    <form enctype="multipart/form-data" method="post"
	  action="{% url todo_add_attachment document.id %}">
	  <!-- id="new-attachment-form" style="display: none;"> -->
      <p>
	{% with attachmentForm as form %}
	{% include "documents/simpleForm.html" %}
	{% endwith %}
	<input type="submit" value="{% trans 'Add' %}" /> 
	<!-- <a href="#" onclick="Element.toggle('new-attachment-form'); this.blur(); return false;">Cancel</a> -->
      </p>
    </form>
  </div>
  <hr />

  <div id="relations">
    <p><strong>{% trans "State" %}</strong></p>
    <form method="post" action="{% url todo_transition  document.id %}">
      <p>
	{% with documentForm as form %}
	{% include "documents/simpleForm.html" %}
	{% endwith %}
	<input type="submit" value="{% trans 'Transition' %}" />
      </p>
    </form>
  </div>
</div>
{% else %}
<p class="nodata">{% trans "No data to display" %}</p>
{% endif %}
{% endblock %}
